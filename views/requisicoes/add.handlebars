<h2>Criar requisição</h2>
<hr>
<div class="card">
    <div class="card-body">
        <div>
			Escolha as colunas:
            
            <div class="btn-group btn-group-toggle btn-group-sm" data-toggle="buttons">
        <label class="btn btn-secondary active">
            <input type="checkbox" name="options" autocomplete="on" checked>
            <a class="toggle-vis" data-column="0">Origem</a>
        </label>
        <label class="btn btn-secondary active">
            <input type="checkbox" name="options" autocomplete="on" checked>
            <a class="toggle-vis" data-column="1">Código</a>
        </label>
        <label class="btn btn-secondary active">
            <input type="checkbox" name="options" autocomplete="on" checked>
            <a class="toggle-vis" data-column="2">Descrição</a>
        </label>
        <label class="btn btn-secondary active">
            <input type="checkbox" name="options" autocomplete="on" checked>
            <a class="toggle-vis" data-column="3">Unidade</a>
        </label>
        <label class="btn btn-secondary active">
            <input type="checkbox" name="options" autocomplete="on" checked>
            <a class="toggle-vis" data-column="4">Preço</a>
        </label>
        <label class="btn btn-secondary active">
            <input type="checkbox" name="options" autocomplete="on" checked>
            <a class="toggle-vis" data-column="5">Observações</a>
        </label>
        </div>        
		</div>
        <table id="table-insumos" style="font-size:13px" class="table table-striped table-bordered table-sm" style="width:100%"> <!-- table table-striped table-sm | table table-striped table-bordered -->
            <thead class="thead-dark">
                <tr>
                    <th>Origem</th>
                    <th>Código</th>
                    <th>Descrição</th>
                    <th>Unidade</th>
                    <th>Preço</th>
                    <th>Observações</th>
                    <th >Ações</th>
                </tr>
            </thead>
            <div id="spinner-insumos"class="d-flex justify-content-center">
                <div class="spinner-border" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
            <tbody id="tbody-insumos" hidden>   
                        
                {{#each insumos}}
                <tr>
                    <td>{{origem.nome}}</td>
                    <td>{{codigo_origem}}</td>
                    <td>{{descricao}}</td>
                    <td>{{unidade_medida}}</td>
                    <td>{{preco_mediano}}</td>
                    <td>{{observacao}}</td>
                    <td> 
                        <button onclick="adicionar_item('{{_id}}')"><i class="material-icons">add_circle</i></button>                           
                    </td>
                </tr>
                {{else}}
                <tr>
                <td><h5>Nenhum insumo cadastrado.</h5></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                </tr>
                {{/each}}            
            </tbody>    
        </table>
    </div>
    <hr>
    <div class="card-body">
        <h4>Ítens adicionados</h4>

        <table style="font-size:13px" id="table-selecionados" class="table table-striped table-bordered table-sm" style="width:100%">
            <thead class="thead-dark">                
                <tr>
                    <th>Ítem</th>
                    <th>Origem</th>
                    <th>Descrição</th>
                    <th>Quantidade</th>
                    <th>Unidade</th>
                    <th>Valor</th>
                    <th>Total</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
                <td></td>
            </tbody>
        </table> 

    </div>
    <div>
        <a href="/requisicoes/enviar"><button class="btn btn-success">Enviar</button></a>
        <a href="/requisicoes/salvar"><button class="btn btn-primary">Salvar</button></a>
    </div>
</div>


<script>  
    $(document).ready( function () {
        var table = $('#table-insumos').DataTable({
            "scrollY": "200px",
            "paging": true
            //"processing": true
            });
        document.getElementById("tbody-insumos").classList.add('visible');        
        document.getElementById("tbody-insumos").removeAttribute('hidden')
        document.getElementById("spinner-insumos").remove();
        
        $('a.toggle-vis').on( 'click', function (e) {
            e.preventDefault();
    
            // Get the column API object
            var column = table.column( $(this).attr('data-column') );
    
            // Toggle the visibility
            column.visible( ! column.visible() );
        });
    });

    function adicionar_item(id) {
        console.log("O id é " + id)
    }
</script>